<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>What do you want to achieve with Varnish? &mdash; Varnish Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.6/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Varnish Documentation  documentation" href="../index.html" />
    <link rel="up" title="Getting Started" href="index.html" />
    <link rel="next" title="Understanding a Typical Website Architecture" href="website_arch.html" />
    <link rel="prev" title="Getting Started" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Varnish Wiki</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://varnish-software.com">Varnish Website</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Menu <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Varnish Web Developer&#8217;s FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/varnish/index.html">How to Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/wordpress/index.html">WordPress with Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/magento2/index.html">Magento2 with Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/drupal/index.html">Drupal with Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/aem.html">Adobe Experience Manager and Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/expressionEngine.html">Expression Engine and Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/sitecoreCMS.html">Sitecore CMS and Varnish</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: Getting Started"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Getting Started</span>
    </a>
  </li>
  <li>
    <a href="website_arch.html" title="Next Chapter: Understanding a Typical Website Architecture"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Understanding... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><div class="container">
    <div class="row">
      <div class="col-md-3" width="18%">
<!---        <div class="sidebar">
</div>
          <div calss="container">  --->
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h3>Contents</h3>
    <div class="sidebar-localtoc">
      <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">What do you want to achieve with Varnish?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#achieving-a-high-hit-rate">Achieving a High Hit rate!</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#varnishtop">varnishtop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#varnishlog">varnishlog</a></li>
<li class="toctree-l4"><a class="reference internal" href="#http-request">HTTP Request</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#managing-your-cookies">Managing your Cookies!</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cookies-from-the-client">Cookies from the Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cookies-from-the-backend">Cookies from the Backend</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-age-header">The Age Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pragma">Pragma</a></li>
<li class="toctree-l4"><a class="reference internal" href="#over-riding-the-ttl">Over-riding the TTL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#http-vary">HTTP Vary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compression">Compression!</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-default-compression-behaviour">The Default Compression Behaviour</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compressing-contents-if-backends-don-t">Compressing Contents if backends Don&#8217;t</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uncompressing-content-before-sending-to-cache">Uncompressing Content before sending to Cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gzip-and-esi">GZIP and ESI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#purging-and-banning">Purging and Banning!</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#http-purging">HTTP Purging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bans">Bans</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forcing-a-cache-miss">Forcing a Cache Miss</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#per-object-cache-invalidation">Per Object Cache Invalidation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flushing-the-entire-cache">Flushing the Entire Cache</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#varnishtest">Varnishtest</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#useful-links-on-this-topic">Useful links on this topic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="website_arch.html">Understanding a Typical Website Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="general_resources.html">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#installing-and-configuring-varnish">Installing and Configuring Varnish</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#step-by-step-configuring-for-web-applications">Step by Step Configuring for Web Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#configuring-for-enterprise-products">Configuring for Enterprise Products</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#configuring-vcl-beyond-the-default">Configuring VCL Beyond the default</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#recipes-for-cache-invalidation">Recipes for Cache Invalidation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Varnish Web Developer&#8217;s FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/varnish/index.html">How to Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/wordpress/index.html">WordPress with Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/magento2/index.html">Magento2 with Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/drupal/index.html">Drupal with Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/aem.html">Adobe Experience Manager and Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/expressionEngine.html">Expression Engine and Varnish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content/tutorials/sitecoreCMS.html">Sitecore CMS and Varnish</a></li>
</ul>

    </div>
  </div>
</div>
<!---          </div>
        </div> --->
      </div>
    </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
  <div class="sidebar-block">
    <div class="sidebar-wrapper">
      <h4>&nbsp;&nbsp;Contribute</h4>
      <ul class="this-page-menu">
        <li><a href="../_sources/start/your_varnish_goals.txt"
               rel="nofollow">Show Source</a></li>
        <li><a href="https://github.com/staiyeba/wiki_varnish/blob/master/source/start/your_varnish_goals.rst"
               rel="nofollow">Show on GitHub</a></li>
        <li><a href="https://github.com/staiyeba/wiki_varnish/edit/master/source/start/your_varnish_goals.rst"
               rel="nofollow">Edit on GitHub</a></li>
      </ul>
    </div>
  </div>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="what-do-you-want-to-achieve-with-varnish">
<span id="your-varnish-goals"></span><h1>What do you want to achieve with Varnish?<a class="headerlink" href="#what-do-you-want-to-achieve-with-varnish" title="Permalink to this headline">¶</a></h1>
<p>Once Varnish is up and running, there is quite a lot of things that you can do.
The three most common features that Varnish is known for are caching, cache
invalidations and load balancing. There are a lot of other services that varnish
provides to enhance this experience for the clients and the service providers.</p>
<p>This section of our wiki is all about;</p>
<ul class="simple">
<li>The performance of your Varnish server,</li>
<li>Fine tuning the performance of your website using Varnish</li>
<li>Compressing your web content</li>
</ul>
<p>You can read more in details about them on the <a class="reference internal" href="#varnish-cache-org">varnish-cache.org</a> site.</p>
<div class="section" id="achieving-a-high-hit-rate">
<span id="achieve-high-hitrate"></span><h2>Achieving a High Hit rate!<a class="headerlink" href="#achieving-a-high-hit-rate" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>To understand your varnish setup better and be able to deal wit it, there are
quite a few tools varnish provides.</div></blockquote>
<div class="section" id="varnishtop">
<h3><a class="reference internal" href="#id1">varnishtop</a><a class="headerlink" href="#varnishtop" title="Permalink to this headline">¶</a></h3>
<p>This tool reads the shared memory logs and continuously presents an updated list
of commonly occurring entries. This can help you identify requested documents,
clients, URLs, user agents etc whatever requests are hitting the backend the most.</p>
<p>To see the top requests sent to the backend use:</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="n">varnishtop</span> <span class="o">-</span><span class="n">i</span> <span class="n">BereqURL</span>
</pre></div>
</div>
<p>To see which URLs the client is requesting:</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="n">varnishtop</span> <span class="o">-</span><span class="n">i</span> <span class="n">ReqURL</span>
</pre></div>
</div>
<p>To see the most popular Accept-encoding header the client is sending:</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span>varnishtop -I ReqHeader:Accept-Encoding
</pre></div>
</div>
</div>
<div class="section" id="varnishlog">
<h3><a class="reference internal" href="#id2">varnishlog</a><a class="headerlink" href="#varnishlog" title="Permalink to this headline">¶</a></h3>
<p>This tool can help you have an inside look at the  requests. The way the varnish
log works is amazing. It is designed to store its logs in a shared memory segment
called Varnish Shared Log (VSL). this memory sement size is fixed, so once the
segment is full, data is over written. So if you really want certain logs to be
stored you need to tell another program to that for you. If you forget to do that,
your data might get over written.</p>
<p>This has its advantage as it saves memory and only saves logs that you require.</p>
<p>Using the command, <cite>varnishlog</cite> gives raw logs.</p>
<p>To see running processes type:</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="n">varnishlog</span> <span class="o">-</span><span class="n">g</span> <span class="n">raw</span>
</pre></div>
</div>
<p>It shows Varnish master process checking up on the caching process.</p>
<p>Go here to understand <a class="reference internal" href="#varnishlog-in-human-language">Varnishlog in Human Language</a> .
Here is the source code for <a class="reference internal" href="#vsltrans">vsltrans</a></p>
</div>
<div class="section" id="http-request">
<h3>HTTP Request<a class="headerlink" href="#http-request" title="Permalink to this headline">¶</a></h3>
<p>There are lots of tools out there that can execute HTTP requests and returns very
informative information. Some of the tools are GET, Seige, HTTPie,</p>
<p>Varnish only cares about the headers. A request sent like the one following will
return header information. Remember Varnish doesnot yet support HTTPS.</p>
<p>To see header information of a site try:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>http -i http://yourvarnishsite.com/
</pre></div>
</div>
<p>This will return information on the http header being passed.</p>
<p>To check whether a site sets cookies for a specific URL try:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>GET -Used http://yourvarnishsite.com/ <span class="p">|</span> grep ^Set-Cookie
</pre></div>
</div>
</div>
</div>
<div class="section" id="managing-your-cookies">
<h2>Managing your Cookies!<a class="headerlink" href="#managing-your-cookies" title="Permalink to this headline">¶</a></h2>
<p>As you have already seen above with each HTTP request there is a bunch of cookies
i.e. headers carrying meta data. One of the things varnish has to do is check these
headers to identify its appropriateness for caching. If you read about the
<cite>ROLE of HTTP Headers</cite> on the varnish cache site, then you probably have read,
&#8220;Please not that when Varnish considers these headers varnish actually considers
itself part of the actual webserver.</p>
<p>So the most important cookies that you should have a look at;</p>
<div class="section" id="cookies-from-the-client">
<h3>Cookies from the Client<a class="headerlink" href="#cookies-from-the-client" title="Permalink to this headline">¶</a></h3>
<p>A piece of code like the one following will dis-regard cookies from login pages:</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp"># include this snippet as part of the vcl_recv in the defaut.vcl file</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="n">url</span> <span class="o">~</span> <span class="s">&quot;^/login/&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">unset</span> <span class="n">req</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">Cookie</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Disregarding graphical files</li>
</ul>
<p>This code is an example of how to disregard all cookies related to css files such
stylesheets and graphics.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp">#vA vcl snippet to remove css cookeis from headers.</span>
</pre></div>
</div>
<p>Another great example of using Regualar expressions to check your cookies:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># a vcl snippet as part of the vcl_recv</span>
<span class="c1"># this helps in removing everythign except a few cookies.</span>
<span class="c1"># exapmple collected from the varnish.cache site.</span>

<span class="n">sub</span> <span class="n">vcl_recv</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">set</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span> <span class="o">=</span> <span class="s2">&quot;;&quot;</span> <span class="o">+</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span><span class="p">;</span>
    <span class="nb">set</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span> <span class="o">=</span> <span class="n">regsuball</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">HTTP</span><span class="o">.</span><span class="n">Cookie</span><span class="p">,</span> <span class="s2">&quot;; +&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">);</span>
    <span class="nb">set</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span> <span class="o">=</span> <span class="n">regsuball</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">HTTP</span><span class="o">.</span><span class="n">Cookie</span><span class="p">,</span> <span class="s2">&quot;;(COOKIE1|COOKIE2)=&quot;</span><span class="p">,</span> <span class="s2">&quot;; </span><span class="se">\1</span><span class="s2">=&quot;</span><span class="p">);</span>
    <span class="nb">set</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span> <span class="o">=</span> <span class="n">regsuball</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">HTTP</span><span class="o">.</span><span class="n">Cookie</span><span class="p">,</span> <span class="s2">&quot;[^ ][^;]*&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="nb">set</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span> <span class="o">=</span> <span class="n">regsuball</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">HTTP</span><span class="o">.</span><span class="n">Cookie</span><span class="p">,</span> <span class="s2">&quot;^[; ]+|[; ]+$ &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>


<span class="c1"># The snippet below does the opposite. picks out the one cookie to be cached</span>

<span class="n">sub</span> <span class="n">vcl_recv</span> <span class="p">{</span>
    <span class="c1"># save the original cookie header so we can mangle it</span>
    <span class="nb">set</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">X</span><span class="o">-</span><span class="n">Varnish</span><span class="o">-</span><span class="n">PHP_SID</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span><span class="p">;</span>
    <span class="c1"># using a capturing sub pattern, extract the continuous string of</span>
    <span class="c1"># alphanumerics that immediately follows &quot;PHPSESSID=&quot;</span>
    <span class="nb">set</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">X</span><span class="o">-</span><span class="n">Varnish</span><span class="o">-</span><span class="n">PHP_SID</span> <span class="o">=</span>
       <span class="n">regsuball</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">X</span><span class="o">-</span><span class="n">Varnish</span><span class="o">-</span><span class="n">PHP_SID</span><span class="p">,</span> <span class="s2">&quot;;? ?PHPSESSID=([a-zA-Z0-9]+)( |;| ;).*&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\1</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="nb">set</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Cookie</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">X</span><span class="o">-</span><span class="n">Varnish</span><span class="o">-</span><span class="n">PHP_SID</span><span class="p">;</span>
    <span class="n">unset</span> <span class="n">req</span><span class="o">.</span><span class="n">X</span><span class="o">-</span><span class="n">Varnish</span><span class="o">-</span><span class="n">PHP_SID</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># collected from https://www.varnish-cache.org/docs/4.1/users-guide/increasing-your-hitrate.html</span>
</pre></div>
</div>
</div>
<div class="section" id="cookies-from-the-backend">
<h3>Cookies from the Backend<a class="headerlink" href="#cookies-from-the-backend" title="Permalink to this headline">¶</a></h3>
<p>if you have set a cookie using &#8216;Set-Cookie&#8217; header as shown in the previous example,
Varnish will not cache the page when using the default configuration. Instead it
will create object, a <cite>hit-for-pass</cite> object.</p>
<p>In such a case if the backend server ends up caching un-necessary cookies, just
unset the Set-Cookie header as shown in example below.</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="nf">vcl_recv</span> <span class="o">{</span>
  <span class="o">...</span>
  <span class="k">unset</span> <span class="nv">req.http.Set-Cookie</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="the-age-header">
<h3>The Age Header<a class="headerlink" href="#the-age-header" title="Permalink to this headline">¶</a></h3>
<p>To understand how long an object can be kept in varnish-cache, there is an Age
header which is set through the default.vcl file and the value can be viewed by
collecting the Age header from the request header as shown below:</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span>varnishlog -I ReqHrader:^Age
</pre></div>
</div>
</div>
<div class="section" id="pragma">
<h3>Pragma<a class="headerlink" href="#pragma" title="Permalink to this headline">¶</a></h3>
<p>Some web applications require request directives on how to process its input.
An example could be that the server sent a header such as <cite>Pragma: nocache</cite>,
then varnish will ignore this header. To support this header, a vcl snippet like
the one below could be added  to the vcl_backend_response o add support for that
header in the th VCL:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">beresp</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">Pragma</span> <span class="o">~</span> <span class="s2">&quot;nocache&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">set</span> <span class="n">beresp</span><span class="o">.</span><span class="n">uncacheable</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="nb">set</span> <span class="n">beresp</span><span class="o">.</span><span class="n">ttl</span> <span class="o">=</span> <span class="mi">120</span><span class="n">s</span><span class="p">;</span> <span class="c1"># how long not to cache this url.</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="over-riding-the-ttl">
<h3>Over-riding the TTL<a class="headerlink" href="#over-riding-the-ttl" title="Permalink to this headline">¶</a></h3>
<p>You will find there are multiple variables available in the <cite>vcl_backend_response</cite>.
The one we are concerned about here is the <cite>beresp.ttl</cite> which defines how long the
object is kept in cache. This <cite>vcl_backened_fetch</cite> function is the backend connection
to the varnish&#8217;s frond end through the subroutine <cite>vcl_recv</cite>.</p>
<p>When a request is passed with <cite>pass</cite> from vcl_recv, the object doesnot go to
the backend without typically being altered by the <cite>vcl_backened_fetch</cite>. If this
subroutine</p>
<p>even if a cache time is defined, but the <cite>vcl_backened_response</cite>
logic is still executed.</p>
<p>So if you read the VCL Basics chapter in the <a class="reference internal" href="#varnish-book">Varnish Book</a> you will learn that
if the request was not passed before reaching the <cite>vcl_backend_response</cite>, the
<cite>beresp.ttl</cite> is still used even when you perform a hit_for_pass in
<cite>vcl_backend_response</cite>. When you perform a pass in vcl_fetch you cache the decision
you made. In other words: If beresp.ttl is set to 7 days as shown in the example
and you issue a pass, the object will be recorded into the cache and remain there
for 5 days, telling Varnish not to cache.</p>
<p>Therefore sometimes overriding the default ttl value can really help resolve
backened problems.</p>
<p>A simple example would be to directly set the beresp.ttl in vcl_backend_response
to a sensible value.</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="k">sub </span><span class="nf">vcl_backend_response</span><span class="p"> {</span>
          <span class="k">set</span> <span class="nv">beresp.ttl</span> <span class="o">=</span> <span class="m">7</span> <span class="n">d</span><span class="p">;</span> <span class="c"># 7 days</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The example below shows the beresp-ttl value set to 5days, that means the url
will be stored in cache for 7days and varnish will not cache it for 7 days.</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="k">sub </span><span class="nf">vcl_backend_response</span><span class="p"> {</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">bereq.url</span> <span class="o">~</span> <span class="s">&quot;^/legacy_broken_cms/&quot;</span><span class="p">)</span> <span class="o">{</span>
          <span class="k">set</span> <span class="nv">beresp.ttl</span> <span class="o">=</span> <span class="m">7</span> <span class="n">d</span><span class="p">;</span>
      <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="http-vary">
<h2>HTTP Vary<a class="headerlink" href="#http-vary" title="Permalink to this headline">¶</a></h2>
<p>The HTTP Vary header is the most insane and not understood header on the internet.
But this header, HTTP vary is used for caching, so in order to cache it is advised
to understand this. It is also capable of doing many other wonderful things.</p>
<p><strong>Warning</strong></p>
<p>Varnish does not necessarily understand the semantics of a header, or
what part triggers different variants of a response. In other words, an
inappropriate use of Vary might create a very large number of cached objects,
and reduce the efficiency of your cache server. Therefore, you must be extremely
cautious when using Vary.</p>
<p>In varnish the vary response header can used to store responses that are based
on the value of cookies.</p>
<p>Refer to <cite>Header Field Definitions, section 14.44 to understand Vary</cite> better.</p>
<p>As you may already know, the URL can be used as a parameter by varnish for caching
purposes. Also it is possible to add custom header values to hash in the <cite>vcl_hash</cite>
subroutine. So in this context if you want your cache to be based on headers, you
can set the Vary header to various types; cookies, Accept-Encoding, X-Varnish, User-Agent,
Accept-Language etc.</p>
<p>This way, different values of your custom header will have different hash values
for each cached resource. But remember that, variations containing the vary response
header share the same hash value.</p>
<p>An example would be when servers issue a <cite>Vary: Accept-Encoding</cite> (it is the most
common usage of Vary) it tells Varnish that it needs to cache a separate version
for every different Accept-Encoding that is coming from the different clients.</p>
<p>This could lower your servers performance but it enhances user experience.</p>
<p>But this could also lead to varnish caching a whole bunch of different types of
headers and reduce efficiency and performance as a whole. Normalizing the
accept-encoding header ensures this problem is solved by storing as less variants
as possible.</p>
<p>The following VCL code shows how to normalize the Accept-Encoding headers:</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="c"># Ths code sets the Accept-Encoding header from the client to either gzip, deflate with a preference for gzip.</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">req.http.Accept-Encoding</span><span class="p">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">req.url</span> <span class="o">~</span> <span class="s">&quot;\.(jpg|png|gif|gz|tgz|bz2|tbz|mp3|ogg)&quot;</span><span class="p">)</span> <span class="o">{</span>
        <span class="c"># No point in compressing these</span>
        <span class="n">remove</span> <span class="nv">req.http.Accept-Encoding</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">elsif</span> <span class="p">(</span><span class="nv">req.http.Accept-Encoding</span> <span class="o">~</span> <span class="s">&quot;gzip&quot;</span><span class="p">)</span> <span class="o">{</span>
        <span class="k">set</span> <span class="nv">req.http.Accept-Encoding</span> <span class="o">=</span> <span class="s">&quot;gzip&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">elsif</span> <span class="p">(</span><span class="nv">req.http.Accept-Encoding</span> <span class="o">~</span> <span class="s">&quot;deflate&quot;</span><span class="p">)</span> <span class="o">{</span>
        <span class="k">set</span> <span class="nv">req.http.Accept-Encoding</span> <span class="o">=</span> <span class="s">&quot;deflate&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="c"># unknown algorithm</span>
        <span class="n">remove</span> <span class="nv">req.http.Accept-Encoding</span><span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Another example to normalize <cite>Accept-Language</cite> header:</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="c"># Normalize Accept-Language</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">req.http.Accept-Language</span><span class="p">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">req.http.Accept-Language</span> <span class="o">~</span> <span class="s">&quot;en&quot;</span><span class="p">)</span> <span class="o">{</span>
        <span class="k">set</span> <span class="nv">req.http.Accept-Language</span> <span class="o">=</span> <span class="s">&quot;en&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">elsif</span> <span class="p">(</span><span class="nv">req.http.Accept-Language</span> <span class="o">~</span> <span class="s">&quot;de&quot;</span><span class="p">)</span> <span class="o">{</span>
        <span class="k">set</span> <span class="nv">req.http.Accept-Language</span> <span class="o">=</span> <span class="s">&quot;de&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">elsif</span> <span class="p">(</span><span class="nv">req.http.Accept-Language</span> <span class="o">~</span> <span class="s">&quot;fr&quot;</span><span class="p">)</span> <span class="o">{</span>
        <span class="k">set</span> <span class="nv">req.http.Accept-Language</span> <span class="o">=</span> <span class="s">&quot;fr&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="c"># unknown language. Remove the accept-language header and</span>
        <span class="c"># use the backend default.</span>
        <span class="k">unset</span> <span class="nv">req.http.Accept-Language</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>One of the best ways to take advantage of vary would be to build the response
header based on cached and non-cached objects. This brings us to the next topic,
Compression!</p>
<p>Note: Some application servers send vary with User-Agent. This as you can tell,
orders varnish to cache a separate copy for every variant client/user-Agent there
is. This could be a disaster depending on the number of variation of cients you
serve on a reqular basis.</p>
</div>
<div class="section" id="compression">
<h2>Compression!<a class="headerlink" href="#compression" title="Permalink to this headline">¶</a></h2>
<p>Does varnish Compress objects? As of varnish 4.0 the default is set to compression
&#8220;ON&#8221;. You can always turn it off. Have a look at the <a class="reference internal" href="#reference-guide">Reference Guide</a></p>
<div class="section" id="the-default-compression-behaviour">
<h3>The Default Compression Behaviour<a class="headerlink" href="#the-default-compression-behaviour" title="Permalink to this headline">¶</a></h3>
<p>Compression is on when you see:</p>
<p>The <cite>http_gzip_support = on</cite>
And beresp.do_gzip and beresp.do_gunzip are NOT used in VCL.</p>
<p><em>Unless</em> while returning from <cite>vcl_recv</cite> with <cite>pipe</cite> or <cite>pass</cite>, Varnish modifies
<cite>req-http-Encoding</cite> that is say, the <cite>req.http.Accept-Encoding</cite> is set to &#8220;gzip&#8221;
that means this client supports compressed content.</p>
<p><em>Also note</em> that if <cite>http_gzip_support</cite> parameter is set to <cite>off</cite>, Varnish will
not alter any headers and if there is a <cite>Vary: Accept-Encoding</cite> set it will deal
with it normally just as explained under HTTP_Vary.</p>
</div>
<div class="section" id="compressing-contents-if-backends-don-t">
<h3>Compressing Contents if backends Don&#8217;t<a class="headerlink" href="#compressing-contents-if-backends-don-t" title="Permalink to this headline">¶</a></h3>
<p>If the backend is not compressing contents, you can tell Varnish to compress the
content before storing it in cache by appending <cite>beresp.do_gzip = true</cite> in the
<cite>vcl_backend_response</cite> as shown below.</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="k">sub </span><span class="nf">vcl_backend_response</span><span class="p"> {</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">beresp.http.content-type</span> <span class="o">~</span> <span class="s">&quot;text&quot;</span><span class="p">)</span> <span class="o">{</span>
        <span class="k">set</span> <span class="nv">beresp.do_gzip</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This code will make the following changes to the object header before inserting
in cache;</p>
<ul class="simple">
<li>set <cite>object.http.Content-Encoding</cite> to <cite>gzip</cite></li>
<li>add <cite>Accept-Encoding</cite> to <cite>obj.http.Vary</cite></li>
<li>Weaken <cite>Etag</cite></li>
</ul>
<p>Note: Don&#8217;t try to compress contents that are uncompressable.</p>
</div>
<div class="section" id="uncompressing-content-before-sending-to-cache">
<h3>Uncompressing Content before sending to Cache<a class="headerlink" href="#uncompressing-content-before-sending-to-cache" title="Permalink to this headline">¶</a></h3>
<p>To uncompress contents before entering cache, you can tell Varnish to uncompress
the content before sending it into cache by appending <cite>beresp.do_gunzip = true</cite>
in the <cite>vcl_backend_response</cite> as shown below.</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="k">sub </span><span class="nf">vcl_backend_response</span><span class="p"> {</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">beresp.http.content-type</span> <span class="o">~</span> <span class="s">&quot;text&quot;</span><span class="p">)</span> <span class="o">{</span>
        <span class="k">set</span> <span class="nv">beresp.do_gunzip</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This makes the following changes to the object header before inserting in cache;</p>
<ul class="simple">
<li>removes <cite>obj.http.Content-Encoding</cite></li>
<li>weaken any Etag (by prepending &#8220;W/&#8221;)</li>
</ul>
</div>
<div class="section" id="gzip-and-esi">
<h3>GZIP and ESI<a class="headerlink" href="#gzip-and-esi" title="Permalink to this headline">¶</a></h3>
<p>If you intend to or are using Edge Side Includes (ESI) you must be aware that ESI
and GZIP work together very well. Varnish will do the decompression of content
for you and recompress it for efficient storage and delivery.</p>
<p>You can read more about <a class="reference internal" href="#gzip-esi">GZIP+ESI</a> with Varnish on the varnish-cache site.</p>
<p>A FAQ on Compression: <a class="reference external" href="https://varnish-cache.org/docs/2.1/faq/http.html">https://varnish-cache.org/docs/2.1/faq/http.html</a></p>
</div>
</div>
<div class="section" id="purging-and-banning">
<h2>Purging and Banning!<a class="headerlink" href="#purging-and-banning" title="Permalink to this headline">¶</a></h2>
<p>One of the most widely used methods of increasing hit-ratio (which is metioned
many times on this website) is by increasing the time-to-live (ttl) of the object.</p>
<p>But as you know, in this era surving outdated content aka stale data is like
serving rotten food that no one will eat.</p>
<p>The solution to this problem is by having a mechanism that will notify varnish
whenever there is fresh-content. There are three mechanisms to achieve this;</p>
<ul class="simple">
<li>HTTP Purging</li>
<li>BANS</li>
<li>Forcing a cache-miss</li>
</ul>
<div class="section" id="http-purging">
<h3>HTTP Purging<a class="headerlink" href="#http-purging" title="Permalink to this headline">¶</a></h3>
<p>A HTTP Purge is very much like a HTTP request except it does something dfferent.</p>
<p>Purging is when an object is requested from cache and then it is discarded. that
means everytime there is fresh data for an object, that object is requested and
<cite>purged</cite>. The simplest way to achieve this is by using the code given below:</p>
<div class="highlight-VCL"><div class="highlight"><pre><span></span><span class="k">acl </span><span class="vg">purge </span><span class="p">{</span>
        <span class="s">&quot;localhost&quot;</span><span class="p">;</span>
        <span class="s">&quot;x.x.x.x&quot;</span><span class="o">/</span><span class="m">24</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">vcl_recv</span><span class="p"> {</span>
        <span class="c"># this code below allows PURGE from localhost and x.x.x.x</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">req.method</span> <span class="o">==</span> <span class="s">&quot;PURGE&quot;</span><span class="p">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">client.ip</span> <span class="o">~</span> <span class="no">purge</span><span class="p">)</span> <span class="o">{</span>
                        <span class="k">return</span><span class="p">(</span><span class="no">synth</span><span class="p">(</span><span class="m">405</span><span class="o">,</span><span class="s">&quot;Not allowed.&quot;</span><span class="p">));</span>
                <span class="o">}</span>
                <span class="k">return</span> <span class="p">(</span><span class="no">purge</span><span class="p">);</span>
        <span class="o">}</span>
<span class="o">}</span>

<span class="c"># Notice the return (purge) this means that this subroutine will end here and</span>
<span class="c"># jump to the next sub routine vcl_hash without appending to the built-in vcl_recv</span>
<span class="c"># To read more on this go to https://www.varnish-cache.org/docs/trunk/users-guide/purging.html</span>
</pre></div>
</div>
</div>
<div class="section" id="bans">
<h3>Bans<a class="headerlink" href="#bans" title="Permalink to this headline">¶</a></h3>
<p>Bans can be implemented for objects that are known to frequently change.
In such a case, certain contents are banned to be retrieved from the cache based
on the meta data. The ban is quite a reliable method, as it only works for objects
in the cache but doesnot interfere with new content being cached or served.</p>
<p>Support for bans is built-in to varnish and it is available from the CLI.</p>
<p>For example to ban every jpeg and png object from baching, you can try the
following example;</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#banning images with png and jpeg extension</span>

<span class="n">sub</span> <span class="n">vcl_recv</span><span class="p">{</span>

  <span class="n">ban</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;example.com&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">req</span><span class="o">.</span><span class="n">url</span> <span class="o">~</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">.png$&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Another example of a BAN:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># banning certain URLs

sub vcl_recv {
        if (req.method == &quot;BAN&quot;) {
                # Same ACL check as above:
                if (!client.ip ~ purge) {
                        return(synth(403, &quot;Not allowed.&quot;));
                }
                ban(&quot;req.http.host == &quot; + req.http.host +
                      &quot; &amp;&amp; req.url == &quot; + req.url);

                # Throw a synthetic page so the
                # request won&#39;t go to the backend.
                return(synth(200, &quot;Ban added&quot;));
        }
}


# reference : https://www.varnish-cache.org/docs/trunk/users-guide/purging.html
</pre></div>
</div>
</div>
<div class="section" id="forcing-a-cache-miss">
<h3>Forcing a Cache Miss<a class="headerlink" href="#forcing-a-cache-miss" title="Permalink to this headline">¶</a></h3>
<p>This mechanism is similar to flushing the entire cache, as in it follows the
procedure that when an object is not found in the cache it is served from the
backened. But it also very much like Bans. However cache miss is more reliable as
it this is forced and very much like refreshing a page. This method refreshes an
object by forcing a cache miss for a request. Thus enabling a force fetch from the
backend and overriding the current one. But the old object does remain in the cache
until its ttl expires. The above mentioned methods have their subroutines pre-written
in the <code class="docutils literal"><span class="pre">/etc/varnish/default.vcl</span></code> i.e.`req.hash_always_miss` in <cite>vcl_recv</cite> and
can be configured and used as required.</p>
</div>
</div>
<div class="section" id="per-object-cache-invalidation">
<h2>Per Object Cache Invalidation<a class="headerlink" href="#per-object-cache-invalidation" title="Permalink to this headline">¶</a></h2>
<p>Per object cache invalidation is something you want to use if you want to specify
individual objects for caching. This requires a great understanding of objects
and cache invalidation.</p>
<p>Say for example, If you want to invalidate selected objects but, you can determine
which objects viewers have requested and invalidate only those objects.</p>
</div>
<div class="section" id="flushing-the-entire-cache">
<h2>Flushing the Entire Cache<a class="headerlink" href="#flushing-the-entire-cache" title="Permalink to this headline">¶</a></h2>
<p>One of the ways maybe people prefer to do cache invalidation is by flushing the
entire cache thus forcing varnish to fetch from the backend. Which helps in re-filling
the cache with fresh contents. This could be scripted to take place several times
an hour based on the amount of changes made on the website. Keeping that in mind,
if a huge amount of change is made in a short time, this mechanism could slow down
the response rate as varnish will be visiting the backend more often.</p>
<p>This is obviously not a recommended method for everyday use. But flushing the whole
cache sometimes wouldn&#8217;t hurt.</p>
<div class="section" id="varnishtest">
<h3>Varnishtest<a class="headerlink" href="#varnishtest" title="Permalink to this headline">¶</a></h3>
<p>Last but not the least, use varnishtest to test your policies
before running them in production. Use the <a class="reference internal" href="#vtctrans">vtctrans</a> if you need help reading the
verbose output.</p>
</div>
</div>
<div class="section" id="useful-links-on-this-topic">
<h2>Useful links on this topic<a class="headerlink" href="#useful-links-on-this-topic" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#varnish-tips-and-tricks">Varnish Tips and Tricks</a>
.. <span class="target" id="varnishlog-in-human-language">Varnishlog in Human Language</span>: <a class="reference external" href="http://vsltrans.varnish.jp/">http://vsltrans.varnish.jp/</a>
.. <span class="target" id="vsltrans">vsltrans</span>: <a class="reference external" href="https://github.com/xcir/vsltrans">https://github.com/xcir/vsltrans</a>
.. <span class="target" id="varnish-tips-and-tricks">Varnish Tips and Tricks</span>: <a class="reference external" href="https://ffwagency.com/blog/varnish-tips-and-tricks">https://ffwagency.com/blog/varnish-tips-and-tricks</a>
.. <span class="target" id="reference-guide">Reference Guide</span>: <a class="reference external" href="https://www.varnish-cache.org/docs/4.1/reference/varnishd.html#varnishd-1">https://www.varnish-cache.org/docs/4.1/reference/varnishd.html#varnishd-1</a>
.. <span class="target" id="varnish-cache-org">varnish-cache.org</span>: <a class="reference external" href="https://www.varnish-cache.org/docs/4.1/users-guide/performance.html#users-performance">https://www.varnish-cache.org/docs/4.1/users-guide/performance.html#users-performance</a>
.. <span class="target" id="id1">varnishtop</span>: <a class="reference external" href="https://www.varnish-cache.org/docs/4.1/reference/varnishtop.html#varnishtop-1">https://www.varnish-cache.org/docs/4.1/reference/varnishtop.html#varnishtop-1</a>
.. <span class="target" id="id2">varnishlog</span>: <a class="reference external" href="https://www.varnish-cache.org/docs/4.1/reference/varnishlog.html#varnishlog-1">https://www.varnish-cache.org/docs/4.1/reference/varnishlog.html#varnishlog-1</a>
.. <span class="target" id="varnish-book">Varnish Book</span>: <a class="reference external" href="https://book.varnish-software.com">https://book.varnish-software.com</a>
.. <span class="target" id="header-field-definitions-section-14-44-to-understand-vary">Header Field Definitions, section 14.44 to understand Vary</span>: <a class="reference external" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</a>
.. <span class="target" id="gzip-esi">GZIP+ESI</span>: <a class="reference external" href="https://www.varnish-cache.org/docs/trunk/phk/gzip.html#phk-gzip">https://www.varnish-cache.org/docs/trunk/phk/gzip.html#phk-gzip</a>
.. <span class="target" id="vtctrans">vtctrans</span>: <a class="reference external" href="https://github.com/xcir/vtctrans">https://github.com/xcir/vtctrans</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Varnish Software Group.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>